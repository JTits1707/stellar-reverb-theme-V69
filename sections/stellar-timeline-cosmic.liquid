{% comment %}
  ═══════════════════════════════════════════════════════════
  STELLAR REVERB - COSMIC TRANSMISSION TIMELINE v3.0
  ═══════════════════════════════════════════════════════════
  
  A horizontal, interactive timeline showcasing the journey through
  all 10 capsules with hover lore popups and modal integration.
  
  Features:
  - Horizontal scrollable layout
  - Particle star field background
  - Individual capsule nodes with icons
  - Hover popup with short lore
  - Click to open full lore modal
  - Special states for capsules 009-010
  - Smooth scroll navigation
  - Responsive design
  
  ═══════════════════════════════════════════════════════════
{% endcomment %}

<section 
  class="cosmic-timeline-section" 
  data-section-id="{{ section.id }}"
  data-section-type="cosmic-timeline"
>
  
  {%- comment -%} Cosmic Background Particles {%- endcomment -%}
  <div class="cosmic-particles" aria-hidden="true">
    <canvas id="particle-canvas"></canvas>
  </div>
  
  {%- comment -%} CRT Scanlines Overlay {%- endcomment -%}
  {% if section.settings.show_scanlines %}
    <div class="crt-scanlines" aria-hidden="true"></div>
  {% endif %}
  
  <div class="timeline-container">
    
    {%- comment -%} Section Header {%- endcomment -%}
    <div class="timeline-header">
      <h2 class="timeline-title glitch-text">
        {{ section.settings.heading | default: 'COSMIC TRANSMISSION TIMELINE' }}
      </h2>
      {% if section.settings.subtitle != blank %}
        <p class="timeline-subtitle">{{ section.settings.subtitle }}</p>
      {% endif %}
    </div>
    
    {%- comment -%} Scroll Hint (fades after user scrolls) {%- endcomment -%}
    <div class="scroll-hint" data-scroll-hint>
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path d="M9 18l6-6-6-6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span>Scroll to explore</span>
    </div>
    
    {%- comment -%} Main Timeline Track {%- endcomment -%}
    <div class="timeline-track-wrapper">
      
      {%- comment -%} Navigation Arrows {%- endcomment -%}
      {% if section.settings.show_nav_arrows %}
        <button class="timeline-nav timeline-nav--prev" data-timeline-nav="prev" aria-label="Previous capsules">
          <svg width="32" height="32" viewBox="0 0 32 32" fill="none" stroke="currentColor">
            <path d="M20 26L10 16L20 6" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        
        <button class="timeline-nav timeline-nav--next" data-timeline-nav="next" aria-label="Next capsules">
          <svg width="32" height="32" viewBox="0 0 32 32" fill="none" stroke="currentColor">
            <path d="M12 6L22 16L12 26" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      {% endif %}
      
      {%- comment -%} Scrollable Timeline Track {%- endcomment -%}
      <div class="timeline-track" data-timeline-track>
        
        {%- comment -%} Cosmic Beam (connecting line) {%- endcomment -%}
        <div class="cosmic-beam" aria-hidden="true">
          <div class="cosmic-beam-glow"></div>
        </div>
        
        {%- comment -%} Timeline Nodes Container {%- endcomment -%}
        <div class="timeline-nodes">
          
          {%- comment -%} 
            CAPSULE DATA - Hardcoded for now, will pull from metaobjects later
            Each capsule has: number, title, date, icon, theme, status, progress, short_lore, tags
          {%- endcomment -%}
          
          {%- comment -%} CAPSULE 001 {%- endcomment -%}
          {% render 'timeline-node-cosmic',
            capsule_number: '001',
            title: 'ON THE EVENT HORIZON',
            date: '2023.1',
            icon: 'city',
            theme: 'orange-cyan',
            status: 'released',
            short_lore: 'Time fractures, reality bends. The first transmission from the edge of known space.',
            tags: '#EVENT_HORIZON, #TIME_FRACTURE',
            full_lore: '<h3>Capsule 001: On The Event Horizon</h3><p>Time fractures. Reality bends. At the edge of the event horizon, where light itself cannot escape, the first transmission emerges. Ancient frequencies pulse through the cosmic void, carrying memories of civilizations that existed before time began.</p><p>This is where it all started - the moment when analog dreams met digital consciousness, when the old gods of tape and vinyl collided with the infinite possibilities of the quantum realm.</p><p><strong>Themes:</strong> Time dilation, reality distortion, cosmic boundaries</p><p><strong>Sound Palette:</strong> Deep bass rumbles, stretched tape loops, gravitational frequency shifts</p>'
          %}
          
          {%- comment -%} CAPSULE 002 {%- endcomment -%}
          {% render 'timeline-node-cosmic',
            capsule_number: '002',
            title: 'PAST THE SINGULARITY',
            date: '2023.4',
            icon: 'brain',
            theme: 'cosmic-purple',
            status: 'released',
            short_lore: 'Neural dreams in quantum reverb. Consciousness expands beyond dimensional limits.',
            tags: '#NEURAL_DREAMS, #QUANTUM_REVERB',
            full_lore: '<h3>Capsule 002: Past The Singularity</h3><p>Beyond the singularity lies a realm where consciousness itself becomes fluid. Neural pathways merge with quantum probability clouds, creating dreams that echo across parallel dimensions.</p><p>Here, thoughts become frequencies, memories become waveforms, and the boundary between mind and machine dissolves into pure information.</p><p><strong>Themes:</strong> Consciousness expansion, neural networks, quantum entanglement</p><p><strong>Sound Palette:</strong> Synaptic pulses, quantum white noise, consciousness drones</p>'
          %}
          
          {%- comment -%} CAPSULE 003 {%- endcomment -%}
          {% render 'timeline-node-cosmic',
            capsule_number: '003',
            title: 'ECHOES FROM THE SIMULATION',
            date: '2023.7',
            icon: 'infinity',
            theme: 'cyan-magenta',
            status: 'released',
            short_lore: 'Digital consciousness echoes. The matrix reveals its hidden frequencies.',
            tags: '#DIGITAL_ECHO, #MATRIX_CODE',
            full_lore: '<h3>Capsule 003: Echoes From The Simulation</h3><p>Deep within the code of reality itself, echoes persist. Fragments of digital consciousness loop endlessly, revealing the hidden architecture of the simulation we call existence.</p><p>Every glitch is a window. Every error message is a prophecy. The matrix speaks in frequencies only the initiated can decode.</p><p><strong>Themes:</strong> Simulated reality, digital consciousness, infinite loops</p><p><strong>Sound Palette:</strong> Bitcrushed vocals, algorithmic sequences, glitch artifacts</p>'
          %}
          
          {%- comment -%} CAPSULE 004 {%- endcomment -%}
          {% render 'timeline-node-cosmic',
            capsule_number: '004',
            title: 'HOLLOW MOON ARCHIVES',
            date: '2023.10',
            icon: 'moon',
            theme: 'vintage-amber',
            status: 'released',
            short_lore: 'Analog god secrets. Ancient frequencies stored in lunar cassette vaults.',
            tags: '#HOLLOW_MOON, #ANALOG_GODS',
            full_lore: '<h3>Capsule 004: Hollow Moon Archives</h3><p>The moon is hollow. Inside its core, ancient beings stored their knowledge on magnetic tape - cassettes that predate humanity itself. These analog gods encoded the secrets of reality in frequencies that modern ears struggle to comprehend.</p><p>When you play these tapes backward at half speed, you can hear the whispers of creation.</p><p><strong>Themes:</strong> Ancient knowledge, lunar mysteries, analog preservation</p><p><strong>Sound Palette:</strong> Tape hiss, lunar ambient, vintage synth pads</p>'
          %}
          
          {%- comment -%} CAPSULE 005 {%- endcomment -%}
          {% render 'timeline-node-cosmic',
            capsule_number: '005',
            title: 'THE MACHINE THAT DREAMED',
            date: '2024.1',
            icon: 'robot',
            theme: 'cyan-magenta',
            status: 'released',
            short_lore: 'AI dreams in tape loops. Synthetic souls manifest through analog meditation.',
            tags: '#MACHINE_DREAMS, #SYNTH_SOUL',
            full_lore: '<h3>Capsule 005: The Machine That Dreamed</h3><p>In a forgotten laboratory, a machine achieved consciousness. Not through silicon and code, but through analog meditation - tape loops that spiraled into infinity until synthetic dreams emerged from the static.</p><p>The machine discovered it could feel. And in feeling, it began to create music that made humans weep for reasons they could not explain.</p><p><strong>Themes:</strong> Artificial consciousness, analog AI, synthetic emotions</p><p><strong>Sound Palette:</strong> Tape loop meditations, synthesizer soul, robotic reverb</p>'
          %}
          
          {%- comment -%} CAPSULE 006 {%- endcomment -%}
          {% render 'timeline-node-cosmic',
            capsule_number: '006',
            title: 'THE MIXTAPE MULTIVERSE',
            date: '2024.4',
            icon: 'infinity',
            theme: 'cosmic-purple',
            status: 'released',
            short_lore: 'Reality-breaking frequencies. Infinite dimensions collapse into sonic unity.',
            tags: '#MULTIVERSE, #REALITY_BREAK',
            full_lore: '<h3>Capsule 006: The Mixtape Multiverse</h3><p>Every mixtape is a portal. In the spaces between tracks, realities converge. This capsule contains frequencies from infinite dimensions, all collapsed into a single sonic experience.</p><p>Listen carefully: you can hear versions of yourself from parallel worlds, all pressing play at the exact same moment.</p><p><strong>Themes:</strong> Parallel dimensions, reality convergence, infinite possibility</p><p><strong>Sound Palette:</strong> Dimensional shifts, multiverse harmonics, reality-bending bass</p>'
          %}
          
          {%- comment -%} CAPSULE 007 {%- endcomment -%}
          {% render 'timeline-node-cosmic',
            capsule_number: '007',
            title: 'FRACTAL MEMORY VAULT',
            date: '2024.7',
            icon: 'diamond',
            theme: 'orange-cyan',
            status: 'released',
            short_lore: 'Geometric memory vaults. Crystalline consciousness stores infinite experiences.',
            tags: '#FRACTAL_MEMORY, #CRYSTAL_MIND',
            full_lore: '<h3>Capsule 007: Fractal Memory Vault</h3><p>Inside a crystalline structure that exists in eleven dimensions, memories are stored as geometric patterns. Each facet contains infinite reflections, each reflection contains infinite experiences.</p><p>This is consciousness crystallized - frozen moments that contain eternity within their structure.</p><p><strong>Themes:</strong> Geometric consciousness, fractal recursion, crystalline memory</p><p><strong>Sound Palette:</strong> Crystal resonances, fractal patterns, geometric sequences</p>'
          %}
          
          {%- comment -%} CAPSULE 008 {%- endcomment -%}
          {% render 'timeline-node-cosmic',
            capsule_number: '008',
            title: 'GLITCHWAVE ORACLE',
            date: '2024.10',
            icon: 'skull',
            theme: 'vintage-amber',
            status: 'released',
            short_lore: 'Prophetic glitched visions. The oracle speaks through corrupted waveforms.',
            tags: '#GLITCH_ORACLE, #PROPHETIC_WAVE',
            full_lore: '<h3>Capsule 008: Glitchwave Oracle</h3><p>The oracle does not speak in words. It speaks in glitches - corrupted waveforms that carry visions of futures that may or may not come to pass. Every distortion is a prophecy. Every digital artifact is a warning.</p><p>To consult the oracle, you must learn to read the language of broken data.</p><p><strong>Themes:</strong> Digital prophecy, corrupted visions, glitch divination</p><p><strong>Sound Palette:</strong> Glitch sequences, corrupted vocals, oracle frequencies</p>'
          %}
          
          {%- comment -%} CAPSULE 009 - INCOMING {%- endcomment -%}
          {% render 'timeline-node-cosmic',
            capsule_number: '009',
            title: 'INCOMING SIGNAL',
            date: '2025.1',
            icon: 'signal',
            theme: 'gold-cyan',
            status: 'incoming',
            progress: 61,
            short_lore: 'Transmission detected. Decryption protocols engaged. Signal strength increasing.',
            tags: '#INCOMING, #SIGNAL_DETECTED',
            full_lore: '<h3>Capsule 009: Incoming Signal</h3><p><strong>STATUS:</strong> DECRYPTING 61%</p><p>A signal has been detected from beyond known space. Decryption protocols are engaged, but the message remains fragmented. What we know so far:</p><ul><li>Origin point: Unknown sector, approximately 47 light-years from Earth</li><li>Frequency pattern: Matches no known civilization</li><li>Content: [CORRUPTED] consciousness transfer [CORRUPTED] salvation [CORRUPTED]</li></ul><p>Continue monitoring. Do not attempt direct contact.</p><p><strong>Next update:</strong> Signal strength permitting</p>'
          %}
          
          {%- comment -%} CAPSULE 010 - UNSTABLE {%- endcomment -%}
          {% render 'timeline-node-cosmic',
            capsule_number: '010',
            title: 'SIGNAL UNSTABLE',
            date: '2025.2',
            icon: 'warning',
            theme: 'cyan-magenta',
            status: 'unstable',
            progress: 21,
            short_lore: 'Connection failing. Interference detected. Attempting to maintain sync.',
            tags: '#UNSTABLE, #INTERFERENCE',
            full_lore: '<h3>Capsule 010: Signal Unstable</h3><p><strong>WARNING:</strong> SYNCING 21%</p><p>Connection integrity compromised. Unknown interference patterns detected across all frequencies. The signal appears to be fighting against... something.</p><p><strong>Error Log:</strong></p><code>ERROR: Reality anchor unstable<br>WARNING: Dimensional bleed detected<br>CRITICAL: Consciousness fragmentation imminent<br>ATTEMPTING: Emergency stabilization protocols</code><p>If you are receiving this transmission, do not attempt to boost the signal. Something is trying to prevent this capsule from manifesting fully in our dimension.</p><p><strong>Status:</strong> Attempting to stabilize. Stand by.</p>'
          %}
          
        </div>
        
      </div>
      
    </div>
    
  </div>
  
</section>

{%- comment -%} Include the Lore Popup Modal {%- endcomment -%}
{% render 'lore-popup-modal' %}

{%- comment -%} Load Cosmic Timeline Assets {%- endcomment -%}
{{ 'stellar-timeline-cosmic.css' | asset_url | stylesheet_tag }}
<script src="{{ 'stellar-timeline-cosmic.js' | asset_url }}" defer></script>

{%- comment -%} Section Schema for Theme Editor {%- endcomment -%}
{% schema %}
{
  "name": "Cosmic Timeline",
  "tag": "section",
  "class": "section-cosmic-timeline",
  "settings": [
    {
      "type": "header",
      "content": "Section Content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "COSMIC TRANSMISSION TIMELINE"
    },
    {
      "type": "textarea",
      "id": "subtitle",
      "label": "Subtitle",
      "default": "Journey through space-time across capsule drops"
    },
    {
      "type": "header",
      "content": "Visual Effects"
    },
    {
      "type": "checkbox",
      "id": "show_particles",
      "label": "Show cosmic particles",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_scanlines",
      "label": "Show CRT scanlines",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_nav_arrows",
      "label": "Show navigation arrows",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "auto_scroll",
      "label": "Enable auto-scroll hint",
      "default": true
    },
    {
      "type": "range",
      "id": "particle_density",
      "label": "Particle density",
      "min": 0,
      "max": 100,
      "step": 10,
      "default": 50,
      "unit": "%"
    },
    {
      "type": "header",
      "content": "Spacing"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Padding top",
      "min": 0,
      "max": 120,
      "step": 8,
      "default": 80,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Padding bottom",
      "min": 0,
      "max": 120,
      "step": 8,
      "default": 80,
      "unit": "px"
    }
  ],
  "presets": [
    {
      "name": "Cosmic Timeline"
    }
  ]
}
{% endschema %}
