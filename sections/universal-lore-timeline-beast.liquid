{% comment %}
  =====================================================
  UNIVERSAL LORE: ARCHIVE TIMELINE (Beast Mode)
  - Loops through Metaobject: capsule
  - Triggers slide-up animations via JS
  =====================================================
{% endcomment %}

<section class="lore-timeline" id="lore-timeline">
  <div class="timeline-signal-path"></div>
  
  <div class="timeline-container">
    <header class="timeline-header">
      <span class="hud-label">CHRONICLE_STREAM</span>
      <h2 class="timeline-main-title">THE TRANSMISSION LOGS</h2>
    </header>

    <div class="timeline-stream">
      {% comment %} Replace 'capsule' with your specific metaobject handle {% endcomment %}
      {% for capsule in shop.metaobjects.capsule.values %}
        <div class="timeline-node" 
             data-capsule="{{ capsule.number }}" 
             data-product-url="{{ capsule.collection_link }}"
             data-section-type="timeline-node">
          
          <div class="node-marker-wrapper">
            <div class="node-marker">
              <div class="node-marker-inner"></div>
            </div>
            <div class="node-connector"></div>
          </div>

          <div class="node-content">
            <span class="node-id">CAPSULE_{{ capsule.number | default: '???' }}</span>
            <h3 class="node-title">{{ capsule.title }}</h3>
            
            <div class="node-lore-box">
              <p class="node-teaser">{{ capsule.lore_summary }}</p>
              
              <div class="waveform-mini" aria-hidden="true">
                <span class="wave-bar"></span>
                <span class="wave-bar"></span>
                <span class="wave-bar"></span>
                <span class="wave-bar"></span>
              </div>
            </div>

            {% if capsule.collection_link != blank %}
              <a href="{{ capsule.collection_link }}" class="node-link">
                [ EXTRACT_RELICS_V.{{ capsule.number }} ]
              </a>
            {% endif %}
          </div>
        </div>
      {% endfor %}
      
      {% comment %} The "Incoming" Signal Placeholder {% endcomment %}
      <div class="timeline-node incoming-signal" data-capsule="incoming">
        <div class="node-marker-wrapper">
          <div class="node-marker pulse-error"></div>
        </div>
        <div class="node-content">
          <span class="node-id">ERROR: SIGNAL_LOST</span>
          <h3 class="node-title">FUTURE_NOT_YET_DECODED</h3>
          <p class="node-teaser">The algorithm is dreaming. Standby for the next frequency shift.</p>
        </div>
      </div>
    </div>
  </div>
</section>
