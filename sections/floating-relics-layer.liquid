{% comment %}
  =====================================================
  FLOATING RELICS LAYER (Shopify 2.0)
  =====================================================
  
  Features:
  - Floating cassette tapes, apparel relics, glyph fragments
  - Subtle parallax motion on scroll
  - Neon glow effects
  - Performance optimized
{% endcomment %}

{%- liquid
  assign relic_count = section.settings.relic_count | default: 12
  assign enable_parallax = section.settings.enable_parallax | default: true
-%}

<div class="floating-relics-layer" id="floatingRelics-{{ section.id }}" data-parallax="{{ enable_parallax }}" data-section-id="{{ section.id }}">
  {%- for i in (1..relic_count) -%}
    <div class="floating-relic relic-{{ i }}" data-speed="{{ forloop.index | modulo: 3 | plus: 1 }}"></div>
  {%- endfor -%}
</div>

<style>
  .floating-relics-layer {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 0;
    pointer-events: none;
    opacity: 0.4;
  }
  
  .floating-relic {
    position: absolute;
    opacity: 0.6;
    animation: relicFloat 20s infinite ease-in-out;
    filter: blur(0.5px);
  }
  
  /* Cassette Tapes */
  .floating-relic:nth-child(4n+1) {
    width: 40px;
    height: 28px;
    background: linear-gradient(135deg, rgba(40, 168, 214, 0.3), rgba(0, 240, 172, 0.3));
    border-radius: 3px;
    box-shadow: 0 0 15px rgba(40, 168, 214, 0.5);
  }
  
  .floating-relic:nth-child(4n+1)::before {
    content: '';
    position: absolute;
    width: 8px;
    height: 8px;
    background: rgba(0, 0, 0, 0.5);
    border-radius: 50%;
    top: 50%;
    left: 8px;
    transform: translateY(-50%);
  }
  
  .floating-relic:nth-child(4n+1)::after {
    content: '';
    position: absolute;
    width: 8px;
    height: 8px;
    background: rgba(0, 0, 0, 0.5);
    border-radius: 50%;
    top: 50%;
    right: 8px;
    transform: translateY(-50%);
  }
  
  /* Apparel Relics (T-shirt shapes) */
  .floating-relic:nth-child(4n+2) {
    width: 35px;
    height: 35px;
    background: linear-gradient(135deg, rgba(225, 60, 250, 0.3), rgba(40, 168, 214, 0.3));
    clip-path: polygon(20% 0%, 80% 0%, 100% 20%, 100% 100%, 0% 100%, 0% 20%);
    box-shadow: 0 0 15px rgba(225, 60, 250, 0.5);
  }
  
  /* Glyph Fragments (Triangles) */
  .floating-relic:nth-child(4n+3) {
    width: 0;
    height: 0;
    border-left: 20px solid transparent;
    border-right: 20px solid transparent;
    border-bottom: 35px solid rgba(0, 240, 172, 0.3);
    filter: drop-shadow(0 0 15px rgba(0, 240, 172, 0.5));
  }
  
  /* Circular Glyphs */
  .floating-relic:nth-child(4n) {
    width: 30px;
    height: 30px;
    border: 3px solid rgba(244, 255, 48, 0.3);
    border-radius: 50%;
    box-shadow: 0 0 15px rgba(244, 255, 48, 0.5);
  }
  
  /* Positioning - scattered across viewport */
  .relic-1 { left: 5%; top: 10%; animation-delay: 0s; }
  .relic-2 { left: 15%; top: 60%; animation-delay: 2s; }
  .relic-3 { left: 25%; top: 30%; animation-delay: 4s; }
  .relic-4 { left: 35%; top: 75%; animation-delay: 6s; }
  .relic-5 { left: 45%; top: 20%; animation-delay: 8s; }
  .relic-6 { left: 55%; top: 50%; animation-delay: 10s; }
  .relic-7 { left: 65%; top: 15%; animation-delay: 12s; }
  .relic-8 { left: 75%; top: 65%; animation-delay: 14s; }
  .relic-9 { left: 85%; top: 35%; animation-delay: 16s; }
  .relic-10 { left: 10%; top: 80%; animation-delay: 18s; }
  .relic-11 { left: 90%; top: 45%; animation-delay: 3s; }
  .relic-12 { left: 50%; top: 85%; animation-delay: 7s; }
  
  @keyframes relicFloat {
    0%, 100% {
      transform: translate(0, 0) rotate(0deg);
    }
    25% {
      transform: translate(10px, -15px) rotate(5deg);
    }
    50% {
      transform: translate(-5px, -25px) rotate(-3deg);
    }
    75% {
      transform: translate(15px, -10px) rotate(7deg);
    }
  }
  
  /* Hide on mobile for performance */
  @media (max-width: 768px) {
    .floating-relics-layer {
      display: none;
    }
  }
</style>

<script>
  (function() {
    const relicsLayer = document.getElementById('floatingRelics-{{ section.id }}');
    
    if (!relicsLayer || relicsLayer.dataset.parallax !== 'true') return;
    
    // Simple parallax effect on scroll
    let ticking = false;
    
    window.addEventListener('scroll', function() {
      if (!ticking) {
        window.requestAnimationFrame(function() {
          const scrolled = window.pageYOffset;
          const relics = relicsLayer.querySelectorAll('.floating-relic');
          
          relics.forEach(function(relic) {
            const speed = parseFloat(relic.dataset.speed) || 1;
            const yPos = -(scrolled * speed * 0.05);
            relic.style.transform = 'translateY(' + yPos + 'px)';
          });
          
          ticking = false;
        });
        
        ticking = true;
      }
    });
  })();
</script>

{% schema %}
{
  "name": "Floating Relics Layer",
  "class": "floating-relics-layer-section",
  "settings": [
    {
      "type": "range",
      "id": "relic_count",
      "min": 6,
      "max": 20,
      "step": 2,
      "label": "Relic Count",
      "default": 12,
      "info": "Number of floating relics (cassettes, apparel, glyphs)"
    },
    {
      "type": "checkbox",
      "id": "enable_parallax",
      "label": "Enable Parallax Motion",
      "default": true,
      "info": "Subtle parallax effect on scroll"
    }
  ],
  "presets": [
    {
      "name": "Floating Relics Layer"
    }
  ]
}
{% endschema %}
