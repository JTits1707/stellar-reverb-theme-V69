<!doctype html>
<html
  class="no-js"
  lang="{{ request.locale.iso_code }}"
>
  <head>
    <meta charset="utf-8">
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1"
    >

    {%- comment -%}
      SEO / Title
    {%- endcomment -%}
    <title>
      {%- if page_title == blank -%}
        {{ 'general.meta.title' | t: shop_name: shop.name }}
      {%- else -%}
        {{ page_title }}{% unless page_title contains shop.name %} – {{ shop.name }}{% endunless %}
      {%- endif -%}
    </title>

    {%- if page_description -%}
      <meta
        name="description"
        content="{{ page_description | escape }}"
      >
    {%- else -%}
      <meta
        name="description"
        content="Stellar Reverb – cosmic apparel, analog mysticism, and wearable soundscapes broadcasting from the edge of reality."
      >
    {%- endif -%}

    <meta name="theme-color" content="#0D0D0D">

    {%- comment -%}
      Favicon (update file name as needed)
    {%- endcomment -%}
    <link
      rel="icon"
      type="image/png"
      href="{{ 'favicon.png' | asset_url }}"
    >

    {%- comment -%}
      Preconnects for performance
    {%- endcomment -%}
    <link rel="preconnect" href="https://cdn.shopify.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    {%- comment -%}
      Fonts – Orbitron / Exo / Montserrat / Inter
      If you're using Shopify font settings, you can remove this and rely on {{ settings.typography_* }}
    {%- endcomment -%}
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=Montserrat:wght@300;400;500;600;700&display=swap"
    >

    {%- comment -%}
      CSS Variables from Theme Settings (Brand Tokens)
    {%- endcomment -%}
    <style>
      :root {
        --void-black: {{ settings.color_void_black | default: '#0D0D0D' }};
        --neon-magenta: {{ settings.color_neon_magenta | default: '#E13CFA' }};
        --cyan-blue: {{ settings.color_cyan_blue | default: '#28A8D6' }};
        --radioactive-green: {{ settings.color_radioactive_green | default: '#00F0AC' }};
        --cosmic-purple: {{ settings.color_cosmic_purple | default: '#6C24B3' }};
        --electric-yellow: {{ settings.color_electric_yellow | default: '#F4FF30' }};
        --chrome-silver: {{ settings.color_chrome_silver | default: '#B0B0B0' }};

        --font-title: 'Orbitron', system-ui, sans-serif;
        --font-body: 'Montserrat', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      }

      html {
        font-family: var(--font-body);
        background-color: var(--void-black);
        color: #f9fafb;
      }
    </style>

    {%- comment -%}
      Core CSS – order matters:
      1) Critical (above-the-fold, if you have it)
      2) Base / theme
      3) Stellar Reverb performance / lore styling
    {%- endcomment -%}
    {% if 'stellar-reverb-critical.css' | asset_url %}
      {{ 'stellar-reverb-critical.css' | asset_url | stylesheet_tag }}
    {% endif %}

    {{ 'base.css' | asset_url | stylesheet_tag }}

    {% if 'stellar-reverb-performance.css' | asset_url %}
      {{ 'stellar-reverb-performance.css' | asset_url | stylesheet_tag }}
    {% endif %}

    {%- comment -%}
      Shopify required, apps, analytics, etc.
    {%- endcomment -%}
    {{ content_for_header }}

    {%- comment -%}
      JSON-LD baseline schema (you can expand later)
    {%- endcomment -%}
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "{{ shop.name | escape }}",
        "url": "{{ shop.url }}",
        "logo": "{{ 'stellar-logo.png' | asset_url }}",
        "sameAs": [
          {% if settings.social_instagram != blank %}"{{ settings.social_instagram }}"{% endif %}
        ]
      }
    </script>
  </head>

  <body
    class="
      template-{{ template.name | handle }}
      template-{{ template | replace: '.', '-' | replace: '/', '-' }}
    "
  >
    {%- comment -%}
      Accessibility: skip link
    {%- endcomment -%}
    <a
      class="skip-to-content sr-only focus:not-sr-only"
      href="#MainContent"
    >
      {{ 'accessibility.skip_to_content' | t | default: 'Skip to main content' }}
    </a>

    {%- comment -%}
      Header (navigation, logo, cart, etc.)
      Use your existing header section handle here (likely 'header')
    {%- endcomment -%}
    {% section 'header' %}

    {%- comment -%}
      Page main content
    {%- endcomment -%}
    <main
      id="MainContent"
      role="main"
      tabindex="-1"
      class="main-content"
    >
      {{ content_for_layout }}
    </main>

    {%- comment -%}
      Footer (global)
    {%- endcomment -%}
    {% section 'footer' %}

    {%- comment -%}
      Core JS – global theme logic
    {%- endcomment -%}
    {% if 'global.js' | asset_url %}
      <script src="{{ 'global.js' | asset_url }}" defer></script>
    {% endif %}

    {%- comment -%}
      Page-specific JS:
      Lore engine for universal lore pages / sections
      Shopify template check keeps it light where unused.
    {%- endcomment -%}
    {% if template contains 'universal-lore' or template contains 'lore' %}
      {% if 'stellar-reverb-lore.js' | asset_url %}
        <script src="{{ 'stellar-reverb-lore.js' | asset_url }}" defer></script>
      {% endif %}
    {% endif %}

    {%- comment -%}
      Optional: Shop All filters / interactions
    {%- endcomment -%}
    {% if template contains 'collection.shop-all' %}
      {% if 'stellar-shop-all.js' | asset_url %}
        <script src="{{ 'stellar-shop-all.js' | asset_url }}" defer></script>
      {% endif %}
    {% endif %}

    {%- comment -%}
      Optional: service worker for PWA-ish feel
    {%- endcomment -%}
    <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker
          .register('{{ "sw.js" | asset_url }}')
          .catch(function (error) {
            console.log('Service worker registration failed', error);
          });
      }
    </script>
  </body>
</html>
